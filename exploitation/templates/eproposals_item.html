{% extends 'page.html' %}
{% load static bootstrap4 personal_tags %}

{% block include_header %}
    <!-- DaData -->
    <link rel="stylesheet" href="{% static "css/suggestions-15.12.css" %}">

    <!-- Choosen select -->
    <link rel="stylesheet" href="{% static "css/prism.css" %}">
    <link rel="stylesheet" href="{% static "css/chosen.min.css" %}">

    <!-- Multiple Checkboxes in Select -->
    <link rel="stylesheet" href="{% static "css/multiple-select.css" %}">
{% endblock %}

{% block page_title %}Заявка{% endblock %}
{% block section_active %}
    {% if request_data %}
        №{{ request_data.id }}
    {% else %}
        новая
    {% endif %}
{% endblock %}

{% block content %}
    <div class="container" style="margin-bottom: 30px;">
        <form action="
            {% if request_data %}
                {% url 'exploitation:addget_eproposals' request_data.id %}
            {% else %}
                {% url 'exploitation:addget_eproposals' %}
            {% endif %}" method="post" class="form">
            {% csrf_token %}
            {% bootstrap_form_errors form %}
            {% if request_data %}
                <ul class="list-inline">
                    <li class="list-inline-item">
                        {% if request_data.Create_user %}Добавлено: {{ request_data.Create_user|view_shortfio_user }} <small>{{ request_data.DateTime_add|date:"d.m.Y" }}</small>{% endif %}
                    </li>|
                    <li class="list-inline-item">
                        {% if request_data.Update_user %}Обновлено: {{ request_data.Update_user|view_shortfio_user }} <small>{{ request_data.DateTime_update|date:"d.m.Y" }}</small>{% endif %}
                    </li>
                </ul>
            {% endif %}
            <div>
                {% bootstrap_field form.ServiceCompany layout='horizontal' %}
            </div>
            <div class="form-group">
                <div class="row">
                    <div class="col-3" style="padding-top: 5px;">
                        {% bootstrap_label "Объект" label_for="requestdate" %}
                    </div>
                    <div class="col-3">
                        {% bootstrap_field form.NumObject layout='inline' %}
                    </div>
                    <div class="col-6">
                        {% bootstrap_field form.AddressObject layout='inline' %}
                    </div>
                </div>
            </div>
            <div>
                {% bootstrap_field form.Client_words layout='horizontal' %}
            </div>
            <div class="form-group">
                <div class="row">
                    <div class="col-3" style="padding-top: 5px;">
                        {% bootstrap_label "Передатчик" label_for="num_transmitter" %}
                    </div>
                    <div class="col-3">
                        {% bootstrap_field form.num_transmitter layout='inline' %}
                    </div>
                    <div class="col-6">
                        {% bootstrap_field form.model_transmitter layout='inline' %}
                    </div>
                </div>
            </div>
            <div>
                {% bootstrap_field form.FaultAppearance layout='horizontal' %}
            </div>
            <div class="form-group">
                <div class="row">
                    <div class="col-3" style="padding-top: 5px;">
                        {% bootstrap_label "Запланировано" label_for="DateTime_schedule" %}
                    </div>
                    <div class="col-2">
                        {% bootstrap_field form.DateTime_schedule layout='inline' %}
                        {{ request.user.has_perm }}
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="row">
                    <div class="col-3" style="padding-top: 5px;">
                        {% bootstrap_label "Выполнено" label_for="DescriptionWorks" %}
                    </div>
                    <div class="col-2">
                        {% bootstrap_field form.DateTime_work layout='inline' %}
                    </div>
                    <div class="col-7">
                        {% bootstrap_field form.DescriptionWorks layout='inline' %}
                    </div>
                </div>
            </div>
            <div>
                {% bootstrap_field form.CoWorkers layout='horizontal' %}
            </div>
            <div>
                {% bootstrap_field form.Client_choices layout='horizontal' %}
            </div>
            <div>
                {% bootstrap_field form.Status layout='horizontal' %}
            </div>
            <div class="form-group">
                <div class="row">
                    <div class="col-4" style="padding-top: 5px;">
{#                        {% bootstrap_label "Акт выполненых работ" label_for="Required_act" %}#}
                        {% bootstrap_field form.Required_act layout='horizontal' %}
                    </div>
                    <div class="col-3">
                        {% bootstrap_field form.Date_act layout='horizontal' %}
                    </div>
                    <div class="col-3 text-right">
                        {% if request_data.Written_act %}
                            Акт выписан
                        {% endif %}
                    </div>
                    <div class="col-2">
                        {% bootstrap_button "Сохранить" button_type="submit" button_class="btn-primary" %}
                    </div>
                </div>
            </div>
        </form>
    </div>
{% endblock %}

{% block include_footer %}
    <!-- DaData -->
    <script src="{% static "js/jquery.suggestions-15.12.min.js" %}" type="text/javascript" ></script>
    <script src="{% static "js/DaData.js" %}" type="text/javascript" ></script>

    <!-- Choosen select -->
    <script src="{% static "js/chosen.jquery.min.js" %}" type="text/javascript"></script>
    <script src="{% static "js/prism.js" %}" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript" src="{% static 'js/jquery.multi-select.js' %}"></script>
    <script type="text/javascript">
        var config = {
            '.chosen-select'           : {},
            '.chosen-select-deselect'  : {allow_single_deselect:true},
            '.chosen-select-no-single' : {disable_search_threshold:10},
            '.chosen-select-no-results': {no_results_text:'Упс, не найдено!'},
            '.chosen-select-width'     : {width:"95%"}
        }
        for (var selector in config) {
            $(selector).chosen(config[selector]);
        }
        $('.multiselect').multiSelect();
    </script>
{% endblock %}